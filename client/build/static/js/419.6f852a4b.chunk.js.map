{"version":3,"file":"static/js/419.6f852a4b.chunk.js","mappings":"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","sources":["utils/adminAPI.ts","pages/profile-page/pages/admin/AddFlag.tsx","pages/profile-page/pages/admin/UsersTable.tsx","pages/profile-page/pages/admin/Admin.tsx"],"sourcesContent":["import axios from \"axios\";\r\nimport config from \"../config/config\";\r\n\r\nexport const getUsers = async () => {\r\n  const {data} = await axios.get(config.API_URL + \"/admin/users\", {\r\n    withCredentials: true\r\n  });\r\n  return data;\r\n};\r\n\r\nexport const createUser = async (login: string, password: string) => {\r\n  if (!login || !password){\r\n    return {err: true, message: \"Заполните все поля!\"}\r\n  }\r\n  const {data} =  await axios.post(config.API_URL + \"/admin/create\", {\r\n    login, password\r\n  }, {withCredentials: true});\r\n  return data;\r\n}\r\n\r\nexport const deleteUser = async (login: string) => {\r\n  const {data} =  await axios.post(config.API_URL + \"/admin/delete\", {\r\n    login\r\n  }, {withCredentials: true});\r\n  return data;\r\n}\r\n\r\nexport const addFlag = async (login: string, flagID: number) => {\r\n  const {data} =  await axios.post(config.API_URL + \"/admin/addFlag\", {\r\n    login, flagID\r\n  }, {withCredentials: true});\r\n  return data;\r\n}\r\n\r\nexport const removeFlag = async (login: string, flagID: number) => {\r\n  const {data} =  await axios.post(config.API_URL + \"/admin/removeFlag\", {\r\n    login, flagID\r\n  }, {withCredentials: true});\r\n  return data;\r\n}\r\n\r\nexport const getFlags = async () => {\r\n  const {data} =  await axios.get(config.API_URL + \"/admin/flags\", {withCredentials: true});\r\n  return data;\r\n}","import React, {ChangeEvent, FC} from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {Checkbox, Tag} from \"antd\";\r\nimport {addFlag, removeFlag} from \"../../../../utils/adminAPI\";\r\n\r\nconst StyledAddFlag = styled.div<StyledProps>`\r\n  position: absolute;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 20px;\r\n  width: 200px;\r\n  top: ${props => props.y}px;\r\n  left: ${props => props.x}px;\r\n  display: ${props => props.isShow ? \"block\" : \"none\"};\r\n  background-color: ${props => props.theme.colors.darkPrimary};\r\n  box-shadow: 0px 0px 12px ${props => props.theme.colors.dark};\r\n  z-index: 99999999999;\r\n`;\r\n\r\nexport interface Flag {\r\n  id: number,\r\n  title: string,\r\n  color: string\r\n}\r\n\r\ninterface StyledProps {\r\n  x: number,\r\n  y: number,\r\n  isShow: boolean,\r\n  onClick: any\r\n}\r\n\r\ninterface AddFlagProps extends StyledProps {\r\n  flags: Array<Flag>,\r\n  includedFlags: Array<number>,\r\n  updateUsers: Function,\r\n  login: string,\r\n}\r\n\r\nexport const AddFlag: FC<AddFlagProps> = ({ x,\r\n                                            y,\r\n                                            isShow,\r\n                                            flags,\r\n                                            includedFlags,\r\n                                            updateUsers,\r\n                                            login,\r\n                                            onClick}) => {\r\n\r\n  return (\r\n    <StyledAddFlag x={x} y={y} isShow={isShow} onClick={onClick}>\r\n      {flags.map(flag => {\r\n        return (\r\n          <Checkbox key={flag.id}\r\n                    style={{margin: \"4px auto\"}}\r\n                    checked={flags.some(() => includedFlags.includes(flag.id))}\r\n                    onChange={(e) => {\r\n                      if (e.target.checked){\r\n                        addFlag(login, flag.id).then(() =>  {\r\n                          updateUsers();\r\n                        })\r\n                      }\r\n                      else{\r\n                        removeFlag(login, flag.id).then(() =>  {\r\n                          updateUsers();\r\n                        });\r\n                      }\r\n                    }}\r\n          >\r\n            <Tag color={flag.color} key={flag.id}>{flag.title}</Tag>\r\n          </Checkbox>)\r\n      })}\r\n    </StyledAddFlag>\r\n  )\r\n}","import React, {MouseEvent, FC, useEffect, useState} from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {LoadingOutlined, PlusOutlined} from \"@ant-design/icons\";\r\nimport {Button, Input, message, Space, Table, Tag} from \"antd\";\r\nimport {createUser, deleteUser, getFlags, getUsers} from \"../../../../utils/adminAPI\";\r\nimport {useSelector} from \"react-redux\";\r\nimport {RootState} from \"../../../../store/store\";\r\nimport {AddFlag, Flag} from \"./AddFlag\";\r\n\r\ninterface User {\r\n  login: string,\r\n  password: string,\r\n  flags: Array<any>\r\n}\r\n\r\nconst StyledTable = styled.div`\r\n\r\n`;\r\n\r\nconst StyledTableFooter = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n\r\n  > * {\r\n    margin: 0px 10px;\r\n  }\r\n`;\r\n\r\nconst AddTag = styled.div`\r\n  cursor: pointer;\r\n  display: inline-block;\r\n  align-items: center;\r\n\r\n`;\r\n\r\nexport const UsersTable: FC = () => {\r\n\r\n  const [fetchedUsers, fetchUsers] = useState<User[] | null>(null);\r\n  const [login, setLogin] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n\r\n  const currentLogin = useSelector<RootState>(state => state.auth.user.login);\r\n\r\n  //Add Tag Menu\r\n\r\n  const [x, setX] = useState(0);\r\n  const [y, setY] = useState(0);\r\n  const [isVisible, setVisible] = useState(false);\r\n  const [flags, setFlags] = useState<Flag[] | null>(null);\r\n  const [flagLogin, setFlagLogin] = useState(\"\");\r\n  const [includedFlags, setIncludedFlags] = useState<number[]>([]);\r\n\r\n  useEffect(() => {\r\n    getUsers().then((data) => {\r\n      if (!data.err) {\r\n        fetchUsers(data.users)\r\n      } else {\r\n        fetchUsers(null);\r\n      }\r\n    })\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    getFlags().then(data => {\r\n      if (!data.err) {\r\n        setFlags(data)\r\n      } else {\r\n        setFlags(null);\r\n      }\r\n    })\r\n  }, [])\r\n\r\n  return (\r\n    <StyledTable onClick={() => {setVisible(false)}}>\r\n\r\n      <AddFlag onClick={(e: MouseEvent<HTMLDivElement>) => {setVisible(false);e.stopPropagation()}}\r\n               x={x}\r\n               y={y}\r\n               isShow={isVisible}\r\n               flags={flags || []}\r\n               includedFlags={includedFlags}\r\n               login={flagLogin}\r\n               updateUsers={() => {\r\n                 getUsers().then((data) => {\r\n                   if (!data.err) {\r\n                     fetchUsers(data.users)\r\n                   } else {\r\n                     fetchUsers(null);\r\n                   }\r\n                 })\r\n               }}/>\r\n\r\n      {!fetchedUsers ?\r\n        <LoadingOutlined style={{fontSize: 24}} spin/> :\r\n\r\n        <Table<User> dataSource={fetchedUsers} footer={() => {\r\n\r\n          const onClick = () => {\r\n            createUser(login, password).then((data) => {\r\n              if (data.err) {\r\n                message.error(data.message);\r\n              } else {\r\n                message.success(\"Успешно!\");\r\n                getUsers().then((data) => {\r\n                  if (!data.err) {\r\n                    fetchUsers(data.users)\r\n                  } else {\r\n                    fetchUsers(null);\r\n                  }\r\n                })\r\n              }\r\n              ;\r\n            });\r\n          }\r\n\r\n          return (\r\n            <StyledTableFooter>\r\n              <Input size=\"large\" placeholder=\"login\" value={login} onChange={(e) => setLogin(e.target.value)}/>\r\n              <Input size=\"large\" placeholder=\"password\" value={password}\r\n                     onChange={(e) => setPassword(e.target.value)}/>\r\n              <Button size=\"large\" onClick={onClick}>Add user</Button>\r\n            </StyledTableFooter>\r\n          )\r\n        }}>\r\n\r\n          <Table.Column key=\"login\" title=\"Login\" dataIndex=\"login\"/>\r\n\r\n          <Table.Column key=\"password\" title=\"Password\" dataIndex=\"password\"/>\r\n\r\n          <Table.Column key=\"flags\" title=\"Flags\" dataIndex=\"flags\" render={(items, record: any) => {\r\n\r\n\r\n            const clickHandler = (e: MouseEvent<HTMLDivElement>) => {\r\n              e.stopPropagation();\r\n              setX(e.clientX);\r\n              setY(e.clientY);\r\n              setVisible(true);\r\n              setIncludedFlags(items.map((item: { color: string, id: number, title: string }) => item.id));\r\n              setFlagLogin(record.login);\r\n            }\r\n\r\n            return (\r\n              <>\r\n                {items.map((item: { color: string, id: number, title: string }) => (\r\n                  <Tag color={item.color} key={item.id}>{item.title}</Tag>))}\r\n                <AddTag onClick={clickHandler}>\r\n                  <Tag color=\"default\"><PlusOutlined/></Tag>\r\n                </AddTag>\r\n              </>\r\n            )\r\n\r\n          }}/>\r\n\r\n          <Table.Column key=\"action\" title=\"Actions\" dataIndex=\"action\" render={(text, record: User) => {\r\n\r\n            const onClick = () => {\r\n              deleteUser(record.login).then((data) => {\r\n                if (data.err) {\r\n                  message.error(data.message);\r\n                } else {\r\n                  message.success(\"Успешно!\");\r\n                  getUsers().then((data) => {\r\n                    if (!data.err) {\r\n                      fetchUsers(data.users)\r\n                    } else {\r\n                      fetchUsers(null);\r\n                    }\r\n                  })\r\n                }\r\n                ;\r\n              })\r\n            }\r\n\r\n            return (\r\n              <>\r\n                {currentLogin === record.login ? \"\" :\r\n                  <Space size=\"middle\">\r\n                    <a onClick={onClick}>Delete {record.login}</a>\r\n                  </Space>}\r\n              </>\r\n            )\r\n          }\r\n\r\n          }/>\r\n\r\n        </Table>\r\n      }\r\n    </StyledTable>\r\n  )\r\n}","import {FC} from \"react\";\r\nimport styled from \"styled-components\";\r\nimport {UsersTable} from \"./UsersTable\";\r\n\r\nconst StyledAdmin = styled.div`\r\n  padding: 10px;\r\n`;\r\n\r\nexport const Admin: FC = () => {\r\n  return(\r\n    <StyledAdmin>\r\n      <UsersTable/>\r\n    </StyledAdmin>\r\n  )\r\n}"],"names":["getUsers","axios","config","withCredentials","data","createUser","login","password","err","message","deleteUser","addFlag","flagID","removeFlag","getFlags","StyledAddFlag","styled","props","y","x","isShow","theme","colors","darkPrimary","dark","AddFlag","flags","includedFlags","updateUsers","onClick","map","flag","style","margin","checked","some","includes","id","onChange","e","target","then","color","title","StyledTable","StyledTableFooter","AddTag","UsersTable","useState","fetchedUsers","fetchUsers","setLogin","setPassword","currentLogin","useSelector","state","auth","user","setX","setY","isVisible","setVisible","setFlags","flagLogin","setFlagLogin","setIncludedFlags","useEffect","users","stopPropagation","dataSource","footer","size","placeholder","value","dataIndex","render","items","record","item","clientX","clientY","PlusOutlined","text","LoadingOutlined","fontSize","spin","StyledAdmin","Admin"],"sourceRoot":""}